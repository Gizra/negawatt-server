!function(a){"undefined"==typeof a&&(a={getCenter:L.Map.prototype.getCenter,setView:L.Map.prototype.setView,setZoomAround:L.Map.prototype.setZoomAround,getBoundsZoom:L.Map.prototype.getBoundsZoom,scaleUpdate:L.Control.Scale.prototype._update}),L.Map.include({getBounds:function(){if(this._viewport)return this.getViewportLatLngBounds();var a=this.getPixelBounds(),b=this.unproject(a.getBottomLeft()),c=this.unproject(a.getTopRight());return new L.LatLngBounds(b,c)},getViewport:function(){return this._viewport},getViewportBounds:function(){var a=this._viewport,b=L.point(a.offsetLeft,a.offsetTop),c=L.point(a.clientWidth,a.clientHeight);return(0===c.x||0===c.y)&&(a=this.getContainer(),a&&(b=L.point(0,0),c=L.point(a.clientWidth,a.clientHeight))),L.bounds(b,b.add(c))},getViewportLatLngBounds:function(){var a=this.getViewportBounds();return L.latLngBounds(this.containerPointToLatLng(a.min),this.containerPointToLatLng(a.max))},getOffset:function(){var a=this.getSize().divideBy(2),b=this.getViewportBounds().getCenter();return a.subtract(b)},getCenter:function(){var b=a.getCenter.call(this);if(this.getViewport()){var c=this.getZoom(),d=this.project(b,c);d=d.subtract(this.getOffset()),b=this.unproject(d,c)}return b},setView:function(b,c,d){if(b=L.latLng(b),c=c||this.getZoom(),this.getViewport()){var e=this.project(b,this._limitZoom(c));e=e.add(this.getOffset()),b=this.unproject(e,this._limitZoom(c))}return a.setView.call(this,b,c,d)},setZoomAround:function(b,c,d){var e=this.getViewport();if(e){var f=this.getZoomScale(c),g=this.getViewportBounds().getCenter(),h=b instanceof L.Point?b:this.latLngToContainerPoint(b),i=h.subtract(g).multiplyBy(1-1/f),j=this.containerPointToLatLng(g.add(i));return this.setView(j,c,{zoom:d})}return a.setZoomAround.call(this,b,c,d)},getBoundsZoom:function(a,b,c){a=L.latLngBounds(a);var d,e=this.getMinZoom()-(b?1:0),f=this.getMaxZoom(),g=this.getViewport(),h=g?L.point(g.clientWidth,g.clientHeight):this.getSize(),i=a.getNorthWest(),j=a.getSouthEast(),k=!0;c=L.point(c||[0,0]);do e++,d=this.project(j,e).subtract(this.project(i,e)).add(c),k=b?d.x<h.x||d.y<h.y:h.contains(d);while(k&&f>=e);return k&&b?null:b?e:e-1}}),L.Control.Scale.include({_update:function(){if(this._map._viewport){var b=this._map.getBounds(),c=b.getCenter().lat,d=6378137*Math.PI*Math.cos(c*Math.PI/180),e=d*(b.getNorthEast().lng-b.getSouthWest().lng)/180,f=this._map.getSize(),g=this.options,h=0,f=new L.Point(this._map._viewport.clientWidth,this._map._viewport.clientHeight);f.x>0&&(h=e*(g.maxWidth/f.x)),this._updateScales(g,h)}else a.scaleUpdate.call(this)}}),L.Map.include({setActiveArea:function(a){if(!this._viewport){var b=this.getContainer();this._viewport=L.DomUtil.create("div",""),b.insertBefore(this._viewport,b.firstChild)}return"string"==typeof a?this._viewport.className=a:L.extend(this._viewport.style,a),this}})}(window.leafletActiveAreaPreviousMethods);